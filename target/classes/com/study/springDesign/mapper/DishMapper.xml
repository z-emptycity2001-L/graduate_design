<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.study.springDesign.mapper.DishMapper">
<!--    三表联查 dish dish_category dish_flavor -->
    <resultMap id="DishMap" type="map">
        <id property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="price" column="price"/>
        <result property="code" column="code"/>
        <result property="image" column="image"/>
        <result property="description" column="description"/>
        <result property="status" column="status"/>
        <result property="categoryId" column="category_id"/>
        <result property="isDelete" column="is_delete"/>
        <association property="dishCategory" javaType="map">
            <id property="categoryId" column="b_id"/>
            <result property="categoryName" column="b_name"/>
        </association>
        <collection property="dishFlavors"
                    column="id"
                    select="com.study.springDesign.mapper.dishFlavorMapper.selectFlavorByIdStep2"
        />
    </resultMap>
    <select id="selectAllDishesStep1" resultMap="DishMap">
        select a.id ,a.name,price,code,image,description,status,a.is_deleted,b.id as b_id,b.name as b_name ,c.id as c_id,c.name as c_name,c.value
        from dish as a left join dish_category as b on a.category_id=b.id
                       left join dish_flavor as c on a.id=c.dish_id;
    </select>
</mapper>